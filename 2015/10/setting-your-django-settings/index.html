<!DOCTYPE html>

<html lang="en-US">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0" />
	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="pingback" href="/xmlrpc.php" />

  <title>Setting your Django settings | CodeCook.io | Blog</title>
<link rel="alternate" type="application/rss+xml" title="CodeCook.io | Blog &raquo; Feed" href="/feed/" />
<link rel="alternate" type="application/rss+xml" title="CodeCook.io | Blog &raquo; Comments Feed" href="/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/blog.codecook.io\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bootstrap-group-css' href='/wp-content/plugins/bwp-minify/cache/minify-b1-bootstrap-1acd2c3b132b8fad94dac2a62d588fde.css' type='text/css' media='screen' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='html5-shiv-group-css' href='/wp-content/plugins/bwp-minify/cache/minify-b1-html5-shiv-7961b8871bb8775a9f10bcb33a1526e0.js' type='text/css' media='all' />
<![endif]-->
<!-- This site uses the Google Analytics by Yoast plugin v5.4.4 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-53158891-2', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('require', 'displayfeatures');
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js'></script>
<script type='text/javascript' src='/wp-content/plugins/bwp-minify/cache/minify-b1-coeur_js-c7b5608b037ed6481b6fe32cb1e6c4a2.js'></script>
<link rel='prev' title='API update -&gt; parameters' href='/2014/12/api-update-parameters/' />
<link rel='canonical' href='/2015/10/setting-your-django-settings/' />
<link rel='shortlink' href='/?p=112' />
<!-- FAVHERO FAVICON START --><link rel="apple-touch-icon-precomposed" href=/wp-content/uploads/2015/03/favicon-152.png><meta name="msapplication-TileColor" content="#FFFFFF"><meta name="msapplication-TileImage" content="/wp-content/uploads/2015/03/favicon-144.png"><!-- For iPhone with high-resolution Retina display running iOS ≥ 7: --><link rel="apple-touch-icon-precomposed" sizes="120x120" href="/wp-content/uploads/2015/03/favicon-120.png"><!-- For first- and second-generation iPad: --><link rel="apple-touch-icon-precomposed" sizes="72x72" href="/wp-content/uploads/2015/03/favicon-72.png"><!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: --><link rel="apple-touch-icon-precomposed" href="/wp-content/uploads/2015/03/favicon-57.png"><!-- FAVHERO FAVICON START -->      <!--Customizer CSS--> 
      <style type="text/css">
            
           .site-description { color:#555; } 
           body { background-color:#f9f9f9; } 
           a, a:hover { color:#00c9bf; }           .btn-primary, .bypostauthor .media-heading, .btn-primary:hover, .btn-primary:focus, .btn-primary:active, .btn-primary.active, .open .dropdown-toggle.btn-primary { background-color:#00c9bf; }           blockquote, .sticky, .form-control:focus, .search-field:focus, .btn-primary, .btn-primary:hover, .btn-primary:focus, .btn-primary:active, .btn-primary.active, .open .dropdown-toggle.btn-primary { border-color:#00c9bf; }           h1 a, .h1 a, h2 a, .h2 a, h3 a, .h3 a, h4 a, .h4 a, h5 a, .h5 a, h6 a, .h6 a { color:#333; }           h1 a, .h1 a, h2 a, .h2 a, h3 a, .h3 a, h4 a, .h4 a, h5 a, .h5 a, h6 a, .h6 a, h1, .h1, h2, .h2, h3, .h3, 
    h4, .h4, h5, .h5, h6, .h6, .site-description { font-weight:100; }           h1 a, .h1 a, h2 a, .h2 a, h3 a, .h3 a, h4 a, .h4 a, h5 a, .h5 a, h6 a, .h6 a, h1, .h1, h2, .h2, h3, .h3, 
    h4, .h4, h5, .h5, h6, .h6, .site-description { font-family:Helvetica Neue; }           body { font-family:Helvetica Neue; }           @media (min-width: 1200px) {
              .container { width:970px; }            }

                            .blog-header {
                    padding-top: 20px;
                    padding-bottom: 20px;
                    text-align: center;
                    background: #fff;
                }
            
                  </style> 
      <!--/Customizer CSS-->
        </head>

  <body class="single single-post postid-112 single-format-standard">
    <div class="wrap">

      <div class="blog-header" style="background:url('');background-size: cover;background-repeat: no-repeat;background-position: center;background-color:#FFF;">
                <div class='site-logo'>
          <a href='/' title='CodeCook.io | Blog' rel='home'><img src='/wp-content/uploads/2015/03/codecook_io_blog_logo1.png' alt='CodeCook.io | Blog'></a>
          <h1 class="blog-title"><a href="">CodeCook.io | Blog</a></h1>
        </div>
              <p class="site-description">Code templates in any language</p>
      </div>


  <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <ul id="menu-menu-1" class="nav navbar-nav">
    <li class="home-link menu-item menu-item-type-post_type menu-item-object-page">
      <a id="search_toggle" href="#"><i class="fa fa-search"></i></a>
    </li>
    <div class="search-box">
      <form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>    </div>
  </ul>
  <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse"><ul id="menu-custom-top-menu" class="nav navbar-nav"><li id="menu-item-27" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27"><a title="Blog &lt;i class=&quot;fa fa-home&quot;&gt;&lt;/i&gt;" href="/"><span class="glyphicon blog.CodeCook.io"></span>&nbsp;Blog <i class="fa fa-home"></i></a></li>
<li id="menu-item-14" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-14"><a title="Code &lt;i class=&quot;fa fa-home&quot;&gt;&lt;/i&gt;" href="http://codecook.io"><span class="glyphicon CodeCook.io"></span>&nbsp;Code <i class="fa fa-home"></i></a></li>
</ul></div></div>
</nav>
<nav class="navbar navbar-default mobile-menu" role="navigation">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="mobile-search">
      <form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>    </div>
    <div class="mobile-toggle navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mobile-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
  <div id="mobile-navbar-collapse" class="collapse navbar-collapse"><ul id="menu-custom-top-menu-1" class="nav navbar-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27"><a title="Blog &lt;i class=&quot;fa fa-home&quot;&gt;&lt;/i&gt;" href="/"><span class="glyphicon blog.CodeCook.io"></span>&nbsp;Blog <i class="fa fa-home"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-14"><a title="Code &lt;i class=&quot;fa fa-home&quot;&gt;&lt;/i&gt;" href="http://codecook.io"><span class="glyphicon CodeCook.io"></span>&nbsp;Code <i class="fa fa-home"></i></a></li>
</ul></div></div>
</nav>
<div class="container">
	<div class="row">

		<main class="col-md-9 col-sm-8 col-xs-12 blog" style="float:left">
			
			
			<article class="post-112 post type-post status-publish format-standard hentry category-tutorial tag-django tag-settings">
	<header>
		<h2 class="blog-post-title"><a href="/2015/10/setting-your-django-settings/" rel="bookmark">Setting your Django settings</a></h2>		<p class="blog-post-meta"><time class="post-meta-date">Posted on <a href="/2015/10/04/" title="Setting your Django settings">October 4, 2015</a></time>  </p>

			</header>
	<div class="post-content">
		<p>The Django web framework is great. Initial setup is quick and easy. The settings file however can become a bit unwieldy as soon as you are having to deal with multiple environments and multiple developers. Also a important issue that is not provided out of the box, keeping sensitive data (keys &amp; passwords) out of source control. We like to help you along by sharing some of our experiences.</p>
<p><span id="more-112"></span></p>
<p>We&#8217;ll walk you through the changes needed to get a great setup. If however you just want your setup to work, skip to the end to see the resulting code.</p>
<h2>Local and production settings</h2>
<p>You’ve gotten to the stage where locally the website is running great. And now you want to use it in production. This means you probably have a separate configuration for your:</p>
<ul>
<li>database</li>
<li>logging</li>
<li>email server</li>
<li>caching server</li>
</ul>
<p>Django <strong>settings.py</strong> file does not support different environments out of the box so we are left to our own devices. There are two straightforward ways of supporting multiple configurations.</p>
<ol>
<li>Define a variable <strong><em>ENVIRONMENT</em></strong>` in the settings file and conditionally set variables based on the value.</li>
<li>Have multiple configuration files sharing a common setup.</li>
</ol>
<p>Both setups have their merits but we prefer multiple configuration files because it is easier to read and maintain.</p>
<p>&nbsp;</p>
<h3>Split settings</h3>
<p>The minimal setup we want to have is as follows:</p>
<ul>
<li><strong>settings.py</strong>: Common settings for both local and production.</li>
<li><strong>settings_production.py</strong>: Production only configuration.</li>
<li><strong>settings_development.py</strong> : Developer machines settings.</li>
</ul>
<p>All of these setting files live in the project root folder (for now). As an example this should suffice. You might want to go all out and also have a <strong>Test</strong> and <strong>Acceptance</strong> file so you have the full <a title="DTAP setup" href="https://en.wikipedia.org/wiki/Development,_testing,_acceptance_and_production" target="_blank">DTAP setup</a>.</p>
<p>&nbsp;</p>
<h3>Configuration inheritance</h3>
<p>Both the developer and production settings should have the entire configuration defined in <strong>settings.py</strong>. Because the settings files are python scripts this is actually remarkably easy using an import statement. Both the production and development file should start with:</p>
<pre><code></code><code>from settings import *</code><code></code></pre>
<p>So <strong>settings_production.py</strong> contains:</p>
<pre><code>from settings import *
DEBUG = False</code></pre>
<p>And <strong>settings_development.py</strong> starts out:</p>
<pre><code>from settings import *</code>
<code>DEBUG = True</code><code></code></pre>
<p>&nbsp;</p>
<h3>Django, manage it</h3>
<p>These bits of codes are almost enough. You’ll also need to specify that we no longer want to use just the <strong>settings.py</strong> file when executing Django commands or running the server. For this we’ll edit the <strong>manage.py</strong> file. Change the line:</p>
<pre><code>os.environ.setdefault("DJANGO_SETTINGS_MODULE", "myApp.settings")</code>
<code></code></pre>
<p>to</p>
<pre><code>os.environ.setdefault("DJANGO_SETTINGS_MODULE", "myApp.settings_production")</code>
<code></code></pre>
<p>Where the value depends on the environment you are working on. On the production machine you’ll probably also want to change the <strong>wsgi.py</strong> file so it references the <em><strong>production</strong></em> file rather than the standard settings file. The procedure is the same as for the <strong>manage.py</strong> file.</p>
<p>&nbsp;</p>
<h2>Settings directory</h2>
<p>Although everything up to this point should be enough to deal with multiple environments it’s a bit clunky. The project root folder is littered with settings files, per system the <strong>manage.py</strong> file needs adjustment and configuration secrets are still scattered throughout the files.</p>
<p>Let us start off by putting the setting files in their own directory. Such that the end result looks like:</p>
<ul>
<li>Project root
<ul>
<li>manage.py</li>
<li>myApp
<ul>
<li>wsgi.py</li>
<li>settings
<ul>
<li>__init__.py</li>
<li>settings.py</li>
<li>settings_production.py</li>
<li>settings_development.py</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>&nbsp;</p>
<p>Remember to add the directory sub path to <em><strong>DJANGO_SETTINGS_MODULE</strong></em> for both <strong>manage.py</strong> and <strong>wsgi.py</strong>.</p>
<p>Finally the settings file probably has a <em><strong>BASE_DIR</strong></em> variable. This value should point to the parent directory. Change it to:</p>
<pre><code>BASE_DIR = os.path.join(os.path.abspath(os.path.dirname(__file__)), os.pardir)</code><code>
</code></pre>
<p>&nbsp;</p>
<h3>Keeping your system DRY</h3>
<p>This last bit is really icing on the cake. At this point in time both <strong>manage.py</strong> and <strong>wsgi.py</strong> have a hard coded path to the settings file for that environment. Well that’s not very nice… Lets extract that bit to another file that we exclude from our source control.</p>
<p>In both <strong>manage.py</strong> and <strong>wsgi.py</strong> replace the line</p>
<pre><code>os.environ.setdefault("DJANGO_SETTINGS_MODULE", "myApp.settings.settings_development")</code><code></code></pre>
<p>by</p>
<pre><code>settings_module_path = 'myApp.settings.settings_production`</code>
<code>try:</code>
<code>  from settings_path import *</code>
<code>except ImportError:</code>
<code>  pass</code>
<code>os.environ['DJANGO_SETTINGS_MODULE'] = settings_module_path</code>
<code></code></pre>
<p>&nbsp;</p>
<p>Next create a file <strong>settings_path.py </strong>and add the line:</p>
<pre><code>settings_module_path = 'myApp.settings.settings_development`</code>
<code></code></pre>
<p>These changes will use the production settings unless the <strong>settings_path.py</strong> says otherwise. Now you might change the default. But for us it makes sense to have as many safeguards in place that we don’t accidentally have <code>Debug = True</code> setup on production because a file is missing.</p>
<p>&nbsp;</p>
<h2>pssst, secrets ahead</h2>
<p>Chances are you’ve uploaded the application <em><strong>SECRET_KEY</strong></em> to some source control system. While easy, it doesn’t really seem safe now does it? But don’t take it from us, take it from the Django devs themselves:</p>
<blockquote><p>Warning<br />
<b>Keep this value secret.<br />
</b>Running Django with a known<a href="https://docs.djangoproject.com/en/1.8/ref/settings/#std:setting-SECRET_KEY"> SECRET_KEY</a> defeats many of Django’s security protections, and can lead to privilege escalation and remote code execution vulnerabilities.</p></blockquote>
<p>&#8212; <a title="Django documentation" href="https://docs.djangoproject.com/en/1.8/ref/settings/#secret-key">Django documentation</a></p>
<p>We can put the sensitive settings information in a different file just like all the other things up till now. Create a file <strong>settings/settings_secret.py</strong> with the content:</p>
<pre><code>SECRET_KEY = ‘ABCD123456FGHI’</code></pre>
<p>Now in your <strong>settings/settings.py</strong> file add the line</p>
<pre><code>from settings_secret import *</code><code></code></pre>
<p>Exclude the secret file from your source control (and possibly delete it from the history). Now you have a place to put your application credentials.</p>
<p>&nbsp;</p>
<h2>Concluding</h2>
<p>Your once so simple single file setup has been changed to a myriad of files. But it should be easier to maintain, more secure and is better suited to deal with multiple environments. Just to have everything in one place. Here is a demo project with all the tricks mentioned above:</p>
<p><a href="/wp-content/uploads/2015/10/settings_demo_app.zip">settings_demo_app.zip</a></p>
	</div>
			<p class="post-tags">Tags: <a href="/tag/django/" rel="tag">django</a>, <a href="/tag/settings/" rel="tag">settings</a></p>
			</article>
			
			
		</main> <!-- blog-main -->

		<aside class="sidebar col-md-3 col-sm-4 col-xs-12" style="float:right">
			<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="text-6" class="widget widget_text"><h1 class="widget-title">Looking for code?</h1>			<div class="textwidget"><p>This is the <em>CodeCook blog</em>.</p>

<p>If you are looking for <b>actual code</b> visit 
<a href="http://codecook.io"> CodeCook.io</a></p></div>
		</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="/2015/10/setting-your-django-settings/">Setting your Django settings</a>
						</li>
					<li>
				<a href="/2014/12/api-update-parameters/">API update -> parameters</a>
						</li>
					<li>
				<a href="/2014/11/get-domain-path-protocol-and-get-parameters-in-template/">Get domain, path, protocol and get parameters in Django template</a>
						</li>
					<li>
				<a href="/2014/11/static-social-share-buttons/">Static social share buttons</a>
						</li>
					<li>
				<a href="/2014/11/the-results-are-in/">The results are in!</a>
						</li>
				</ul>
		</aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
	<li><a href='/2015/10/'>October 2015</a></li>
	<li><a href='/2014/12/'>December 2014</a></li>
	<li><a href='/2014/11/'>November 2014</a></li>
		</ul>
</aside>		</aside><!-- /.blog-sidebar -->
	</div> <!-- row -->
</div> <!-- container -->

	<div class="footer-top">
		<div class="container">
			<div class="col-sm-4">
				<aside id="text-5" class="widget widget_text">			<div class="textwidget"></div>
		</aside>			</div>
			<div class="col-sm-4 md-footer-cl">
							</div>
			<div class="col-sm-4">
							</div>
		</div>
	</div>
<div class="blog-footer" style="border-top: 1px solid #ECECEC;background:#FFF;">
	<div class="container">
		<p>&copy; 2016 - <a href="http://codecook.io">Visit CodeCook.io</a></p>
		<p><a href="#"><i class="fa fa-angle-up"></i> Back to top<a></p>
	</div>
</div>
</div> <!-- wrap -->
<script type='text/javascript' src='/wp-content/plugins/bwp-minify/cache/minify-b1-coeur-fitvids-b7ffca4a0796981ea67778f88bbc98c4.js'></script>
</body>
</html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced
Database Caching using disk
Object Caching 804/947 objects using disk

 Served from: blog.codecook.io @ 2016-10-13 18:55:40 by W3 Total Cache -->